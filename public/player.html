<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§†é¢‘æ’­æ”¾ - è§†é¢‘æœåŠ¡å™¨</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="player-container">
        <div class="player-header">
            <div class="player-header-content">
                <span class="dir-badge" id="dirBadge">ğŸ“ åŠ è½½ä¸­...</span>
                <h1 class="video-title" id="videoTitle">åŠ è½½ä¸­...</h1>
            </div>
            <a href="/" class="back-btn">â† è¿”å›åˆ—è¡¨</a>
        </div>

        <div class="video-wrapper">
            <video id="videoPlayer" controls preload="metadata"></video>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            // ä» URL è·å–è§†é¢‘ ID
            const urlParams = new URLSearchParams(window.location.search);
            const videoId = urlParams.get('id');
            
            const dirBadge = document.getElementById('dirBadge');
            const videoTitle = document.getElementById('videoTitle');
            const videoPlayer = document.getElementById('videoPlayer');
            
            if (!videoId) {
                videoTitle.textContent = 'è§†é¢‘IDæ— æ•ˆ';
                dirBadge.textContent = 'âŒ é”™è¯¯';
                return;
            }
            
            try {
                const response = await fetch(`/api/video-info?id=${videoId}`);
                
                if (!response.ok) {
                    throw new Error('è·å–è§†é¢‘ä¿¡æ¯å¤±è´¥');
                }
                
                const info = await response.json();
                
                dirBadge.textContent = `ğŸ“ ${info.dirName}`;
                videoTitle.textContent = info.filename;
                videoPlayer.src = `/api/stream/${videoId}`;
                
            } catch (err) {
                console.error('åŠ è½½è§†é¢‘ä¿¡æ¯å¤±è´¥:', err);
                videoTitle.textContent = 'åŠ è½½å¤±è´¥';
                dirBadge.textContent = 'âŒ é”™è¯¯';
            }
        });
    </script>
</body>
</html>
